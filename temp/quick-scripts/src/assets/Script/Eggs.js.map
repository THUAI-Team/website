{"version":3,"sources":["assets/Script/Eggs.js"],"names":["EGG_COUNT","PLAYER_COUNT","arrayBufferToString","ab","String","fromCharCode","apply","Array","from","Uint8Array","readHeader","view","frameCount","getUint16","fps","redScore","getUint32","yellowScore","blueScore","timestampLeft","timestampRight","timestamp","Date","eggScores","eggScoresOffset","i","getUint8","readFrame","offset","playerInfo","eggInfo","id","x","getFloat32","y","enduranceZipped","push","position","eggInHand","getInt8","endurance","score","readFromRecordFile","blob","DataView","slice","header","frames","frameSizeInBytes","frameNum","abs","number","min","number_a","number_b","cc","Class","Component","properties","containerId","visible","inputBoxId","isPlaying","status","count","type","Integer","limitCount","Player","Prefab","players","Node","Egg","eggs","ground","YellowImgs","Texture2D","RedImgs","BlueImgs","framelabel","start","initInputBox","update","dt","frame","playersInfo","console","log","imgId","playerImgTrans","positionTrans","children","getComponent","Sprite","spriteFrame","SpriteFrame","ProgressBar","progress","eggsInfo","getChildByName","Label","string","arr","sort","a","b","zIndex","step","startSetp","restart","skipTo","num_str","EditBox","num","Number","NaN","InitGPE","CanvasNode","find","instantiate","addChild","game","setFrameRate","inputBox","getInputBox","onchange","evt","fileList","target","files","file","readFile","res","warn","document","getElementById","container","createElement","body","appendChild","onClick","click","fileUrl","callback","reader","FileReader","onload","e","content","result","readAsArrayBuffer","v2","last_position"],"mappings":"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","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\nconst EGG_COUNT = 15, PLAYER_COUNT = 12;\r\nfunction arrayBufferToString(ab) {\r\n    return String.fromCharCode.apply(null, Array.from(new Uint8Array(ab)));\r\n}\r\nfunction readHeader(view) {\r\n    const frameCount = view.getUint16(8, true);\r\n    const fps = view.getUint16(10, true);\r\n    const redScore = view.getUint32(12, true), yellowScore = view.getUint32(16, true), blueScore = view.getUint32(20, true);\r\n    const timestampLeft = view.getUint32(24, true), timestampRight = view.getUint32(28, true);\r\n    const timestamp = new Date(((timestampRight * (2 ** 32)) + timestampLeft) * 1000); // s -> ms\r\n    // NOTE: code above cannot handle years < 1970, but it doesn't matter\r\n    const eggScores = [], eggScoresOffset = 32;\r\n    for (let i = 0; i < EGG_COUNT; i++) {\r\n        eggScores[i] = view.getUint8(eggScoresOffset + i);\r\n    }\r\n    return { frameCount, fps, redScore, yellowScore,\r\n        blueScore, timestamp, eggScores };\r\n}\r\nfunction readFrame(view, eggScores, offset) {\r\n    const playerInfo = [];\r\n    const eggInfo = [];\r\n    for (let id = 0; id < PLAYER_COUNT; id++) {\r\n        const x = view.getFloat32(offset + 120 + 4 * id, true), y = view.getFloat32(offset + 168 + 4 * id, true);\r\n        const enduranceZipped = view.getUint8(offset + 228 + id);\r\n        playerInfo.push({\r\n            id,\r\n            position: [x, y],\r\n            eggInHand: view.getInt8(offset + 216 + id),\r\n            endurance: enduranceZipped / 255.0 * 5.0\r\n        });\r\n    }\r\n    for (let id = 0; id < EGG_COUNT; id++) {\r\n        const x = view.getFloat32(offset + 4 * id, true), y = view.getFloat32(offset + 60 + 4 * id, true);\r\n        eggInfo.push({\r\n            id,\r\n            position: [x, y],\r\n            score: eggScores[id]\r\n        });\r\n    }\r\n    return { playerInfo, eggInfo };\r\n}\r\nfunction readFromRecordFile(blob) {\r\n    const view = new DataView(blob);\r\n    if (arrayBufferToString(blob.slice(0, 6)) !== 'THAIEG' || view.getUint16(6, true) !== 1) {\r\n        return null;\r\n    }\r\n    const header = readHeader(view);\r\n    const frames = [];\r\n    const frameSizeInBytes = 240;\r\n    for (let frameNum = 0, offset = 47; frameNum < header.frameCount; frameNum++, offset += frameSizeInBytes) {\r\n        frames.push(readFrame(view, header.eggScores, offset));\r\n    }\r\n    return { header, frames };\r\n}\r\n\r\nfunction abs(number) {\r\n    return number >= 0 ? number : -number;\r\n}\r\nfunction min(number_a, number_b) {\r\n    return number_a > number_b ? number_b : number_a;\r\n}\r\n\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        containerId : {\r\n            default: \"_filebox_container_\",\r\n            visible: false,\r\n        },\r\n        inputBoxId : {\r\n            default: \"_filebox_input_\",\r\n            visible: false,\r\n        },\r\n        isPlaying : {\r\n            default: false,\r\n            visible: false,\r\n        },\r\n        status : {\r\n            default: -1,\r\n            visible: false,\r\n        },\r\n        count : {\r\n            default: 0,\r\n            type: cc.Integer,\r\n            visible: false,\r\n        },\r\n        limitCount : {\r\n            default: 0,\r\n            type: cc.Integer,\r\n            visible: false,\r\n        },\r\n        header : {\r\n            default: null,\r\n            type: cc.Array,\r\n            visible: false,\r\n        },\r\n        frames : {\r\n            default: null,\r\n            type: cc.Array,\r\n            visible: false,\r\n        },\r\n        Player: cc.Prefab,\r\n        players: {\r\n            default: [],\r\n            type: [cc.Node],\r\n            visible: false,\r\n        },\r\n        Egg : cc.Prefab,\r\n        eggs: {\r\n            default: [],\r\n            type: [cc.Node],\r\n            visible: false,\r\n        },\r\n        ground: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        YellowImgs : {\r\n            default: [],\r\n            type: [cc.Texture2D],\r\n        },\r\n        RedImgs : {\r\n            default: [],\r\n            type: [cc.Texture2D],\r\n        },\r\n        BlueImgs : {\r\n            default: [],\r\n            type: [cc.Texture2D],\r\n        },\r\n        number: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        framelabel: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        // foo: {\r\n        //     // ATTRIBUTES:\r\n        //     default: null,        // The default value will be used only when the component attaching\r\n        //                           // to a node for the first time\r\n        //     type: cc.SpriteFrame, // optional, default is typeof default\r\n        //     serializable: true,   // optional, default is true\r\n        // },\r\n        // bar: {\r\n        //     get () {\r\n        //         return this._bar;\r\n        //     },\r\n        //     set (value) {\r\n        //         this._bar = value;\r\n        //     }\r\n        // },\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {},\r\n\r\n    start () {\r\n        this.initInputBox();\r\n    },\r\n\r\n    update (dt) {\r\n        if(this.isPlaying) {\r\n            if(this.count < this.limitCount) {\r\n                let frame = this.frames[this.count];\r\n\r\n                let playersInfo = frame['playerInfo'];\r\n                for(let i = 0; i < 12; ++i) {\r\n                    let id = playersInfo[i]['id'];\r\n                    let position = playersInfo[i]['position'];\r\n                    let eggInHand = playersInfo[i]['eggInHand'];\r\n                    let endurance = playersInfo[i]['endurance'];\r\n                    //console.log(this.players[id]);\r\n                    if(this.count > 0) {\r\n                        console.log(imgId);\r\n                        let imgId = this.playerImgTrans(this.players[id].position, this.positionTrans(position[0], position[1]));\r\n                        if(imgId != -1) {\r\n                            if(id < 4) {\r\n                                this.players[id].children[0].getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(this.RedImgs[imgId]);\r\n                            }\r\n                            else if(id > 7) {\r\n                                this.players[id].children[0].getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(this.BlueImgs[imgId]);\r\n                            }\r\n                            else {\r\n                                this.players[id].children[0].getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(this.YellowImgs[imgId]);\r\n                            }\r\n                            //console.log(imgId, this.players[id].children[0].spriteFrame);\r\n                        }\r\n                    }\r\n                    // 更新player位置\r\n                    this.players[id].position = this.positionTrans(position[0], position[1]);\r\n                    // 更新耐力显示\r\n                    this.players[id].children[2].getComponent(cc.ProgressBar).progress = endurance / 5;\r\n                    console.log(this.players[id].children[2]);\r\n                }\r\n\r\n                let eggsInfo = frame['eggInfo'];\r\n                for(let i = 0; i < 15; ++i) {\r\n                    let id = eggsInfo[i]['id'];\r\n                    let position = eggsInfo[i]['position'];\r\n                    let score = eggsInfo[i]['score'];\r\n                    this.eggs[id].position = this.positionTrans(position[0], position[1]);\r\n                    this.eggs[id].getChildByName('score').getComponent(cc.Label).string = String(score)\r\n                }\r\n\r\n                let arr = []\r\n                for(let i = 0; i < 12; ++i) {\r\n                    arr.push(this.players[i]);\r\n                }\r\n                for(let i = 0; i < 15; ++i) {\r\n                    arr.push(this.eggs[i]);\r\n                }\r\n                arr.sort((a, b) => {return b.y - a.y});\r\n                for(let i = 0; i < 27; ++i) {\r\n                    arr[i].zIndex = i;\r\n                }\r\n\r\n                console.log(this.count)\r\n                this.framelabel.getComponent(cc.Label).string = String(this.count);\r\n                this.count = this.count + 1;\r\n            }\r\n\r\n        }\r\n    },\r\n\r\n    step() {\r\n        this.limitCount = min(this.limitCount + 1, this.header['frameCount']);\r\n    },\r\n\r\n    startSetp() {\r\n        this.limitCount = this.count;\r\n    },\r\n\r\n    continue() {\r\n        this.limitCount = this.header['frameCount'];\r\n    },\r\n\r\n    restart() {\r\n        this.count = 0;\r\n        this.limitCount = 1;\r\n    },\r\n\r\n    skipTo() {\r\n        let num_str = this.number.getComponent(cc.EditBox).string;\r\n        let num = 0;\r\n        if(Number(num_str) != NaN) {\r\n            num = min(Number(num_str), this.header['frameCount'] - 1);\r\n        }\r\n        else {\r\n            this.number.getComponent(cc.EditBox).string = \"0\";\r\n        }\r\n        this.count = num;\r\n        this.limitCount = num + 1;\r\n    },\r\n\r\n    InitGPE() {\r\n        var CanvasNode = cc.find('Canvas');\r\n        for(let i = 0; i < 12; ++i) {\r\n            this.players.push(cc.instantiate(this.Player));\r\n            this.players[i].getChildByName('id').getComponent(cc.Label).string = String(i);\r\n            if(i < 4) {\r\n                this.players[i].getChildByName('img').getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(this.RedImgs[0]);\r\n            }\r\n            else if(i > 7) {\r\n                this.players[i].getChildByName('img').getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(this.BlueImgs[0]);\r\n            }\r\n            else {\r\n                this.players[i].getChildByName('img').getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(this.YellowImgs[0]);\r\n            }\r\n            CanvasNode.addChild(this.players[i]);\r\n\r\n            //设置帧率\r\n            cc.game.setFrameRate(this.header['fps']);\r\n        }\r\n        for(let i = 0; i < 15; ++i) {\r\n            this.eggs.push(cc.instantiate(this.Egg));\r\n            this.eggs[i].getChildByName('id').getComponent(cc.Label).string = String(i);\r\n            CanvasNode.addChild(this.eggs[i]);\r\n        }\r\n\r\n        this.isPlaying = true;\r\n        this.limitCount = 0;\r\n    },\r\n\r\n    initInputBox() {\r\n        let inputBox = this.getInputBox(this.inputBoxId, this.containerId);\r\n        if(inputBox) {\r\n            inputBox.onchange = (evt) => {\r\n                //console.info(\"===> input value change: \", evt);\r\n                const fileList = evt.target.files;\r\n                //console.info(\"===> file list: \", fileList);\r\n                //console.info(\"===> value: \", inputBox.value);\r\n\r\n                let file = fileList[0];\r\n                if(!file) {\r\n                    //console.info(\"===> No file selected\");\r\n                    return;\r\n                }\r\n                this.readFile(file, (blob) => {\r\n                    let res = readFromRecordFile(blob);\r\n                    this.header = res['header'];\r\n                    this.frames = res['frames'];\r\n                    console.log(this.frames);\r\n                    this.InitGPE();\r\n                });\r\n            };\r\n        }\r\n        else{\r\n            console.warn(\"Can't get or create input box\");\r\n        }\r\n    },\r\n\r\n    getInputBox(inputBoxId, containerId) {\r\n        if(!this.inputBox) {\r\n            let inputBox = document.getElementById(inputBoxId);\r\n            if(!inputBox) {\r\n                let container = document.getElementById(containerId);\r\n                if(!container) {\r\n                    container = document.createElement('div');\r\n                    document.body.appendChild(container);\r\n                    container.id = containerId;\r\n                }\r\n\r\n                inputBox = document.createElement(\"input\");\r\n                inputBox.id = inputBoxId;\r\n\r\n                inputBox.type = \"file\";\r\n\r\n                container.appendChild(inputBox);\r\n            }\r\n            this.inputBox = inputBox;\r\n        }\r\n        return this.inputBox;\r\n    },\r\n    \r\n    onClick() {\r\n        if(this.inputBox) {\r\n            //console.info(\"click start\");\r\n            this.inputBox.click();\r\n            //console.info(\"click done\");\r\n\r\n        }\r\n    },\r\n\r\n    readFile(fileUrl, callback) {\r\n        //console.log(fileUrl);\r\n        let reader = new FileReader();\r\n        reader.onload = function(e) {\r\n            let content = e.target.result;\r\n            // Display file content\r\n            //console.info(\"===> file content: \", content);\r\n            callback(content);\r\n        };\r\n        reader.readAsArrayBuffer(fileUrl);\r\n    },\r\n\r\n    positionTrans(x, y) {\r\n        x = x * 12  + this.ground.x + 33.48;//偏差调整\r\n        y = y * 12  + this.ground.y - 3.5;//偏差调整\r\n        return cc.v2(x, y);\r\n    },\r\n\r\n    playerImgTrans(last_position, position) {\r\n        console.log(last_position, position);\r\n        if(last_position.y == position.y && last_position.x == position.x) {\r\n            return -1;\r\n        }\r\n        if(abs(last_position.y - position.y) > abs(last_position.x - position.x)) {\r\n            return last_position.y > position.y ? 0 : 1;\r\n        }\r\n        else {\r\n            return last_position.x > position.x ? 2 : 3;\r\n        }\r\n    }\r\n});\r\n"]}